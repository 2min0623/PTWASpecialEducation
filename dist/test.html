<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Pie Chart</title>
</head>
<body>
    <canvas id="pieChart" width="400" height="400"></canvas>
    <script>
        const canvas = document.getElementById('pieChart');
        const ctx = canvas.getContext('2d');
        const radius = 200;
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        let division = 10; // 您可以改變這個數字來設定分割的部分數
        let colors = Array(division).fill(null); // 儲存每個部分的顏色

        function drawPieChart() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // 清空畫布
            const angleStep = (2 * Math.PI) / division;
            for (let i = 0; i < division; i++) {
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, i * angleStep, (i + 1) * angleStep);
                ctx.closePath();
                ctx.fillStyle = colors[i] ? colors[i] : 'lightgray'; // 使用已選顏色或預設顏色
                ctx.fill();
                ctx.stroke();
            }
        }

        function getSegmentIndex(x, y) {
            const dx = x - centerX;
            const dy = y - centerY;
            const angle = Math.atan2(dy, dx);
            const adjustedAngle = (angle >= 0 ? angle : (2 * Math.PI + angle));
            return Math.floor(adjustedAngle / ((2 * Math.PI) / division));
        }

        canvas.addEventListener('click', (event) => {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const index = getSegmentIndex(x, y);
            colors[index] = colors[index] ? null : `hsl(${Math.random() * 360}, 100%, 50%)`; // 隨機顏色或取消顏色
            drawPieChart();
        });

        drawPieChart();
    </script>
</body>
</html>
