import{_ as d,a as u,b as m,c as p,d as v,e as x,f}from"./description-52f6e5ba.js";import{_ as w}from"./_plugin-vue_export-helper-c27b6911.js";import{o as c,c as h,a as s,t as l,F as b,h as P}from"./index-76d147a3.js";const S={name:"AutoNumberingGame",data(){return{picture_total:0,QuestionRange:[],picture_type:".png",targetWidth:100,targetHeight:100,minDistance:100,positions:[],exist_image:0,wrong_time:0,level:0,canvas:null,context:null,error_text:null,errorMsg:"",btn:[]}},props:{question:{type:Object,required:!0},answer:{type:Array,required:!0}},created(){this.QuestionRange=this.question.Range;for(var t in this.question.ObjImgList)this.picture_total+=1;for(var t=this.question.Range[0];t<=this.question.Range[1];t++)this.btn.push(t)},mounted(){this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.error_text=document.getElementById("error_msg"),this.loadDescriptionImage()},methods:{getRandPicture(){const t=Math.floor(Math.random()*this.picture_total)+1;var e=new URL(Object.assign({"../../assets/GamePic/Source/S_1.png":d,"../../assets/GamePic/Source/S_2.png":u,"../../assets/GamePic/Source/S_3.png":m,"../../assets/GamePic/Source/S_4.png":p,"../../assets/GamePic/Source/S_5.png":v,"../../assets/GamePic/Source/S_6.png":x})[`../../assets/GamePic/${this.question.Root}/S_${t}${this.picture_type}`],self.location).href;return e},randomPicturePosition(){var t=Math.floor(Math.random()*(this.question.Range[1]-this.question.Range[0]))+this.question.Range[0];const e=new Image;this.exist_image=0,e.src=this.getRandPicture(),this.positions=[],e.addEventListener("load",()=>{for(let i=0;i<t;i++){const o=Math.random()*(this.canvas.width-this.targetWidth),a=Math.random()*(this.canvas.height-this.targetHeight);let r=!1;for(const n in this.positions){const _=this.positions[n][0],g=this.positions[n][1];if(Math.sqrt((o-_)**2+(a-g)**2)<this.minDistance){r=!0;break}}if(r)t+=1;else{this.context.drawImage(e,o,a,this.targetWidth,this.targetHeight);const n=[o,a];this.positions.push(n),this.exist_image+=1}}console.log(this.positions)})},drawCircleWithText(t,e,i){this.context.beginPath(),this.context.arc(t,e,50,0,2*Math.PI),this.context.strokeStyle="black",this.context.lineWidth=1,this.context.stroke(),this.context.fillStyle="black",this.context.font="20px Arial",this.context.textAlign="center",this.context.fillText(i,t,e+70)},judgeAnswer(t){console.log(t),t===this.exist_image?(console.log("Correct"),this.newGame()):this.wrong_time>=3?(this.errorMsg="請根據提示回答答案",this.drawClue()):(t=3-this.wrong_time,this.errorMsg=`錯誤，請再試一次，剩餘${t}次機會`,this.wrong_time+=1)},clearCanvas(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},drawClue(){let t=1;for(const e in this.positions)this.drawCircleWithText(this.positions[e][0]+50,this.positions[e][1]+50,t.toString()),t++},win(){this.level===6&&setTimeout(()=>{location.reload()},3e3)},newGame(){this.level+=1,this.win(),this.errorMsg="",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font="24px Arial",this.context.fillStyle="black",this.context.fillText("答對了",this.canvas.width/2-50,this.canvas.height/2),setTimeout(this.clearCanvas,1500),setTimeout(this.randomPicturePosition,1500)},loadDescriptionImage(){var t=!0;const e=new Image;e.src=new URL(Object.assign({"../../assets/GamePic/Source/description.png":f})[`../../assets/GamePic/${this.question.Root}/description.png`],self.location).href,e.onload=()=>{const i=this.canvas.width/e.width,o=e.height*i;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(e,0,0,this.canvas.width,o),this.canvas.addEventListener("click",()=>{t===!0&&(this.clearCanvas(),this.randomPicturePosition(),t=!1)})}}}},R=s("br",null,null,-1),q=s("br",null,null,-1),G={class:"container"},M={ref:"canvas",width:"700",height:"400"},C={class:"h3"},k=s("p",{class:"h5"},"請點擊下方的按鈕選擇答案",-1),y={id:"error_msg"},I={class:"d-flex flex-row flex-wrap"},T=["onClick"];function A(t,e,i,o,a,r){return c(),h("div",null,[R,q,s("div",G,[s("canvas",M,null,512),s("p",C,l(this.question.Text),1),k,s("div",y,l(a.errorMsg),1),s("div",I,[(c(!0),h(b,null,P(a.btn,(n,_)=>(c(),h("button",{class:"btn btn-primary m-1 flex-grow-1",onClick:g=>r.judgeAnswer(n)},l(n),9,T))),256))])])])}const D=w(S,[["render",A]]);export{D as default};
